# 16. **File Handling with CSV, JSON, and Excel**

File handling is an essential skill when working with data. Python offers various modules and libraries to interact with different file formats, such as **CSV**, **JSON**, and **Excel** files. These formats are commonly used for storing and exchanging data in a structured manner.

## **1. Working with CSV Files**

CSV (Comma Separated Values) files are a simple, widely-used format for storing tabular data. Python’s **`csv`** module provides tools for reading from and writing to CSV files.

### **Reading CSV Files**

You can read CSV files using the `csv.reader` or `csv.DictReader` classes.

* **Using `csv.reader`**:

```python
import csv

with open('data.csv', mode='r') as file:
    reader = csv.reader(file)
    for row in reader:
        print(row)
```

* **Using `csv.DictReader`**: This reads each row as a dictionary, with column headers as keys.

```python
import csv

with open('data.csv', mode='r') as file:
    reader = csv.DictReader(file)
    for row in reader:
        print(row)  # Output: {'Name': 'Alice', 'Age': '30', 'City': 'New York'}
```

### **Writing to CSV Files**

You can write data to a CSV file using the `csv.writer` or `csv.DictWriter` classes.

* **Using `csv.writer`**:

```python
import csv

data = [['Name', 'Age', 'City'], ['Alice', 30, 'New York'], ['Bob', 25, 'Los Angeles']]

with open('output.csv', mode='w', newline='') as file:
    writer = csv.writer(file)
    writer.writerows(data)
```

* **Using `csv.DictWriter`**:

```python
import csv

data = [{'Name': 'Alice', 'Age': 30, 'City': 'New York'}, {'Name': 'Bob', 'Age': 25, 'City': 'Los Angeles'}]

with open('output.csv', mode='w', newline='') as file:
    fieldnames = ['Name', 'Age', 'City']
    writer = csv.DictWriter(file, fieldnames=fieldnames)
    writer.writeheader()
    writer.writerows(data)
```

## **2. Working with JSON Files**

JSON (JavaScript Object Notation) is a lightweight data-interchange format. Python’s **`json`** module allows easy parsing and writing of JSON data.

### **Reading JSON Files**

You can use the `json.load()` function to read JSON data from a file.

```python
import json

with open('data.json', 'r') as file:
    data = json.load(file)
    print(data)  # Output: {'name': 'Alice', 'age': 30, 'city': 'New York'}
```

### **Writing to JSON Files**

You can write Python objects (like dictionaries or lists) to JSON files using the `json.dump()` function.

```python
import json

data = {'name': 'Alice', 'age': 30, 'city': 'New York'}

with open('output.json', 'w') as file:
    json.dump(data, file)
```

### **Formatting JSON Output**

To make the output more readable, you can use the `indent` parameter.

```python
import json

data = {'name': 'Alice', 'age': 30, 'city': 'New York'}

with open('output.json', 'w') as file:
    json.dump(data, file, indent=4)
```

## **3. Working with Excel Files (using `openpyxl` or `pandas`)**

Excel files are widely used for storing tabular data. Python provides several libraries for reading and writing Excel files, such as **`openpyxl`** and **`pandas`**.

### **Using `openpyxl` for Excel Files**

The `openpyxl` library is used to read and write `.xlsx` files.

* **Reading Excel Files**:

```python
import openpyxl

# Open an Excel file
workbook = openpyxl.load_workbook('data.xlsx')
sheet = workbook.active

# Accessing a specific cell
print(sheet['A1'].value)  # Output: Data in cell A1
```

* **Writing to Excel Files**:

```python
import openpyxl

# Create a new workbook
workbook = openpyxl.Workbook()
sheet = workbook.active

# Writing data to cells
sheet['A1'] = 'Name'
sheet['A2'] = 'Alice'

# Save the workbook
workbook.save('output.xlsx')
```

### **Using `pandas` for Excel Files**

**Pandas** simplifies working with Excel files and is often used for handling large datasets.

* **Reading Excel Files**:

```python
import pandas as pd

# Load Excel file into a DataFrame
df = pd.read_excel('data.xlsx')

# Displaying the first few rows
print(df.head())
```

* **Writing to Excel Files**:

```python
import pandas as pd

# Create a DataFrame
data = {'Name': ['Alice', 'Bob'], 'Age': [30, 25]}
df = pd.DataFrame(data)

# Write to Excel file
df.to_excel('output.xlsx', index=False)
```

## **4. Working with CSV, JSON, and Excel in a Single Program**

In some cases, you may need to work with multiple file formats in a single program. Python makes it easy to handle these tasks by using the appropriate libraries (`csv`, `json`, `pandas`, etc.).

### **Example: Converting CSV to JSON**

```python
import csv
import json

# Read CSV file
with open('data.csv', 'r') as csv_file:
    csv_reader = csv.DictReader(csv_file)
    rows = list(csv_reader)

# Write to JSON file
with open('output.json', 'w') as json_file:
    json.dump(rows, json_file, indent=4)
```

## **5. Best Practices for File Handling**

* **Handle exceptions**: Use `try` and `except` to handle potential errors such as file not found or permission errors.

  Example:

  ```python
  try:
      with open('data.csv', 'r') as file:
          data = file.read()
  except FileNotFoundError:
      print("The file was not found.")
  ```

* **Use `with` for file handling**: The `with` statement automatically takes care of closing the file, even if an exception is raised.

* **Keep file formats consistent**: Use the appropriate file format for the task at hand (CSV for tabular data, JSON for structured data, etc.).

* **Optimize large files**: For large files, consider using libraries like `pandas` or `openpyxl`, which are optimized for handling large datasets efficiently.

---

### **Why Work with Files in Python?**

* **Data exchange**: Files are a common way to exchange data between systems, including databases, web applications, and other software systems.
* **Persistence**: Storing data in files allows you to persist information between program runs.
* **Flexibility**: Python’s support for various file formats, including CSV, JSON, and Excel, makes it easy to interact with different types of data, allowing for a wide range of use cases.

Mastering file handling is crucial for building applications that deal with data storage, reporting, and exchange. Whether you're reading large datasets from CSV files, writing JSON data for APIs, or generating Excel reports, Python provides powerful tools for handling file input/output efficiently.
